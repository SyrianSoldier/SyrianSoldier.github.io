# 操作系统

## 第一章: 操作系统概述

### 1.1 操作系统概念
**操作系统( Operating System, OS )**
1. **控制,管理与调度:** 管理整个计算机系统的硬件和软件资源,合理的组织调度计算机的工作和资源的分配
    - 操作系统管理计算机的资源. **资源包括硬件资源和软件资源**.操作系统为每个应用分配一定的资源.
2. **向上层提供服务**: 以提供给用户和其他软件方便的接口和环境
   - <img src="./imgs/os1.jpg" width="231">
   - 操作系统与用户和软件直接交互, 向上层提供方便好用的服务
3. **向下层扩展功能:** 他是计算机系统中最基本的系统软件.
   - 操作系统是最接近硬件的软件. 

### 1.2 操作系统的功能
**1. 从如何管理系统资源的看操作系统的功能**

操作系统通过以下4个模块处理系统资源:
1. 处理机管理
   - 如何给不同应用分配cpu资源, 用于计算数据等
2. 存储器管理
   - 内存如何读写, 磁盘如何读写, 如何分区等
3. 文件管理
   - 文件系统, 文件按照树状结构存储在磁盘当中
4. 设备管理
   - 如同一个摄像头如何给不同的应用使用

操作系统的目标是安全且功效的管理系统资源.

**2. 从向上层提供服务看操作系统的功能**
1. 向用户层提供GUI服务
   - 用户可以通过图形用户接口直接与操作系统交互. 如用户可通过拖拽的方式改变文件存储位置.
2. 向软件层提供程序接口服务
   - **系统调用:** 操作系统提供的程序接口一般又称为**系统调用或者广义指令**
   - **二次封装:** **普通用户不能直接使用系统调用**, 一般来说,高级程序语言会对系统调用进行二次封装, 提供给程序员使用. 
     如操作系统关于网络请求的SocketAPI, 会经过各种高级语言如c++的二次封装, 提供给程序员使用.
   - **系统调用种类(从用户的角度对系统调用分类)**
      1. 脱机命令接口: 又称为批处理接口. 用户说一堆, 系统做一堆.
      2. 联机命令接口: 又称为交互式处理接口. 用户说一句, 系统做一句.


**3. 从向下层拓展功能看操作系统的功能**
裸机指没有**任何软件支持**的计算机.

不太恰当的说, 裸机就是一堆废铜烂铁, 操作系统对逻辑进行扩展, 将逻辑改造成功能更强使用更方便的机器.

通常把覆盖了软件的机器称为扩充机器, 又称为**虚拟机**

### 操作系统的特征
1. 并发
    - **并发:** 指宏观是同时发生, 但是微观是交替发生的
    - **并行:** 指无论是宏观和微观, 不同事情都是在同一时刻发生的
    - **操作系统的并发性:** 指操作系统上运行这多个软件, 在宏观上是同时运行的, 在微观上是交替运行的
    - **单核与多核CPU的并发性:**: 单核CPU在同一时刻只能运行一个软件, 多个软件采用并发的形式运行. 多核CPU同一时刻能运行核数个软件, 
      若运行比核数更多的软件, 也需要并发的形式的形式运行
2. 共享
   - **资源共享:** 共享即资源共享, 即系统资源可以被内存中的多个并发的程序同时使用. 如英雄联盟与网易云音乐同时使用扬声器资源.
   - **资源贡献方式:**
     1. **互斥资源共享:** 一个时间段只允许一个程序使用资源. 如摄像头资源可以被QQ和微信使用, 但QQ占用了摄像头,
        微信在占用期不能再使用摄像头.
     2. **同时资源共享:** 允许一个时间段内多个程序使用资源(同时的意思是并发的使用).
3. 虚拟
    - 虚拟技术指, 将一个物理存在的实体变为若干个逻辑上的对应物的技术.
    - 如时分复用技术, 单核CPU只能运行一个程序, 但通过时分复用, 实现了并发, 可以同时运行多个程序, 看起来是拥有多核CPU一样. 
4. 异步
   - 指的是在多道程序环境下，允许**多个程序并发执行**，但由于资源有限，**进程的执行是不连续、不可预知的**，以不可预知的速度向前推进。
   - 如JavaScript中的Promise, 一个网络请求的Promise将会和主线程的任务栈的并发运行, 即立即发送网络请求. 但由于资源的限制, 主要是网络请求的时间消耗和主线程任务栈任务执行情况的限制, 将不会保证什么时候能执行完.

并发与共享的关系:
- 如果系统失去了并发性, 即系统只有一个程序正在运行, 资源共享没有意义.
- 如果系统失去了共享性, 即即使系统并发的运行着多个程序, 但多个程序无法访问同一资源, 如QQ和微信无法同时发送一个文件. 则并发性没有意义.

综上并发与共享是互为存在条件.
